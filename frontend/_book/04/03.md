# 构建FIS

FIS3的构建不会修改源码，而是通过用户设置，将构建的结果输出到指定的目录

在正式介绍FIS3功能之前，我们给定一个简单的例子，例子下载地址：[demo-simple](https://github.com/fex-team/fis3/blob/dev/doc/demo/demo-simple.tar.gz)

## 命令

下载解压完成后，进入**项目根目录**，执行命令，进行构建。

	fis3 release -d <path>

> * <path> 任意目录
> * fis3 release -h 获取更多参数

构建发布到项目目录的 output 目录下

	fis3 release -d ./output

构建发布到项目父级目录的 dist 子目录下

	fis3 release -d ../dist

发布到其他盘 （Windows）

	fis3 release -d D:\output

## 资源定位

我们在项目根目录执行命令 fis3 release -d ../output 发布到目录 ../output 下。然后通过 **Beyond Compare 4** 工具查看源码和构建结果的内容变化。

文件变化

![](http://fis.baidu.com/fis3/docs/beginning/img/demo-uri-dir-diff_c014450.png)

index.html

![](http://fis.baidu.com/fis3/docs/beginning/img/demo-uri-html-diff_cc9e2f5.png)

style.css

![](http://fis.baidu.com/fis3/docs/beginning/img/demo-uri-css-diff_d75c4d6.png)


如上，构建过程中对资源 URI 进行了替换，替换成了绝对 URL。通俗点讲就是相对路径换成了绝对路径。

这是一个 FIS 的很重要的特性，**资源定位**。

> 资源定位能力，可以有效地分离开发路径与部署路径之间的关系，比如:开发时使用相对路径，部署的静态资源需要到CDN上，这些都可以通过配置来指定。


在默认不配置的情况下只是对资源相对路径修改成了绝对路径。通过配置文件可以轻松分离开发路径（源码路径）与部署路径。比如我们想让所有的静态资源构建后到 static 目录下。

	// 配置配置文件，注意，清空所有的配置，只留下以下代码即可。
	fis.match("*.{png,jpg,css,js}", {
    	release:"./static/$0"
	}); 

同样构建到 ../output 目录下查看变化

	fis3 release -d ../output

![](http://fis.baidu.com/fis3/docs/beginning/img/demo-uri-dir-output_d22b536.png)

以上示例只是更改部署路径，还可以给 url 添加 CDN domain 或者添加文件指纹（时间戳或者md5戳）。

可能有人会疑惑，修改成了绝对路径，本地如何调试开发？下一章将介绍调试的方法。


## 配置文件

默认的配置文件为``fis-conf.js``,FIS3编译的整个流程都是通过配置来控制的。

fis.match

首先介绍设置规则的配置接口

	fis.match(selector, props);

* ``selector``:FIS3 把匹配文件路径的路径作为selector，匹配到的文件会分配给它设置的 ``props``。关于 selector 语法，请参看 [Glob 说明](http://fis.baidu.com/fis3/docs/api/config-glob.html)
* ``props``:编译规则属性，包括文件属性和插件属性，[更多属性](http://fis.baidu.com/fis3/docs/api/config-props.html#%25E5%259F%25BA%25E6%259C%25AC%25E5%25B1%259E%25E6%2580%25A7)


我们修改例子的配置文件 ``fis-conf.js``，添加以下内容

	fis.match('*.{js,css,png,jpg}', {
	    useHash: true
	});
